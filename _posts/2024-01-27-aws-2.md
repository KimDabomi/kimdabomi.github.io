---
layout: single
title: "[AWS] EC2 기초"
categories:
  - aws
sidebar:
  nav: "sidebar-category"
---

### 1. AWS의 명명 규칙

> m5.2xlarge
 
- `m`: 인스턴스 클래스
- `5`: 인스턴스의 세대
- `2xlarge`: 인스턴스 클래스 내에서의 크기

### 2. EC2 Instance Types

#### 범용 인스턴스 (General Purpose)
- 웹서버나 코드 저장소와 같은 다양한 작업에 적합
- 컴퓨팅, 메모리, 네트워킹 간의 균형도 잘 맞음

#### 컴퓨팅 최적화 인스턴스 (Coumpute Optimized)
- `C`로 시작
- 컴퓨터 집약적인 작업에 최적화
- 고성능 프로세서는 일부 데이터의 일괄 처리에 사용하거나 미디어 트랜스코딩 작업 시 혹은 고성능 웹 서버가 필요하거나 고성능 컴퓨팅이라는 HPC 작업을 할 때, 머신 러닝이나 전용 게임 서버가 있을 때 사용함

#### 메모리 최적화 인스턴스 (Memory Optimized)
- `R`로 시작
- 메모리에서 대규모 데이터셋을 처리하는 유형의 작업에 빠른 성능 제공
메모리는 `RAM`을 뜻하고, 대부분 인 메모리 데이터베이스가 되는 고성능의 관계형 또는 비관계형의 데이터베이스에 사용
- `ElasticCache`와 같은 분산 웹스케일 캐시 저장소에도 사용
비즈니스 인텔리전스(`BI`)에 최적화된 인 메모리 데이터베이스와 대규모 비정형 데이터의 실시간 처리를 실행하는 애플리케이션에 사용

#### 스토리지 최적화 인스턴스 (Storage Optimized)
- `I`, `D`, `H1`으로 시작
- 로컬 스토리지에서 대규모의 데이터셋에 액세스할 때 적합
- 고주파 온라인 트랜잭션 처리인 `OLTP` 시스템에 사용
- 관계형과 비관계형인 `NoSQL` 데이터베이스에 사용
- `Redis`같은 메모리 데이터베이스의 캐시나 데이터 웨어하우징 애플맄케이션과 분산 파일 시스템에 사용


### 3. 보안 그룹
- 인스턴스의 방화벽이며, 포트로의 액세스를 통제하여 인증된 `IP` 주소의 범위를 확인함
- 외부에서 인스턴스로 들어오는 인바운드 네트워크를 통제하고, 인스턴스에서 외부로 나가는 아웃바운드 네트워크도 통제함
- 여러 인스턴스에 연결할 수 있으며, 보안 그룹과 인스턴스 간의 일대일 관계는 없음
- 인스턴스에도 여러 보안 그룹을 연결할 수 있음
- 지역과 `VPC` 결합으로 통제되어 있음
- `EC2` 외부에 있음, 외부의 방화벽
- `SSH` 액세스를 위해 하나의 별도의 보안 그룹을 유지하는 것이 좋음
- 타임아웃으로 애플리케이션에 접근할 수 없다면 보안 그룹 문제
- 연결 거부 오류가 생기면 보안 그룹은 실행, 트래픽 통과이지만 애플리케이션에 문제가 생긴 것
- 모든 인바운드 트래픽은 차단, 아웃바운드 트래픽은 허용되어 있음


### 4. SSH

터미널이나 명령줄을 이용해서 원격 머신이나 서버를 제어할 수 있게 해줌
``` shell
ssh -i (pem키 끌어다놓기) ec2-user@(프라이빗 IP주소)
```


### 5. 인스턴스의 구매 옵션
- 예약 인스턴스
  - 기간은 1년 또는 3년, 장기간의 워크로드를 위한 것
  - 오랫동안 데이터베이스를 실행할 계획이라면 예약 인스턴스
- 전환형 예약 인스턴스
  - 유연한 인스턴스 타입
  - 시간이 지나면 인스턴스 타입을 변경하길 원할 때 적절

#### 절약 플랜
- 기간은 1년 또는 3년, 장기간의 워크로드를 위한 것
- 특정한 인스턴스 유형을 약정하는 게 아니라 달러 단위로 특정한 사용량을 약정하는 것으로, 좀더 현대적인 방식

#### 스팟 인스턴스
- 아주 짧은 워크로드를 위한 것, 매우 저렴
- 언제라도 그 인스턴스들이 손실될 수 있어서 신뢰성이 낮음
- 온디멘드에 비해 90%까지 할인 받을 수 있음
- 최대 스팟 가격 정의 후에, 청구 비용이 더 나오지 않은 경우에만 인스턴스가 유지됨
- 청구비용이 더 나오는 경우에는 2분의 유예 기간 동안
- 인스턴스를 중지하거나, 스팟 블록을 사용해서 지정된 기간 동안 스팟 인스턴스를 차단 (1~6시간 가능)
- 드물게 인스턴스가 회수되더라도, 스팟 블록에서는 회수되지 않음
- 배치 작업 및 데이터 분석, 장애 복원력이 뛰어난 워크로드 등에 사용
- 중요한 작업이나 데이터베이스에는 적합하지 않음
- 스팟 요청 - 원하는 인스턴스 수, 최대 가격 등을 정의 
  - 일회성 요청인 경우 스팟 요청이 완료되는 즉시 인스턴스가 시작되고 요청은 사라짐
  - 영구 요청인 경우, 스팟 요청이 인스턴스가 중지되어도 계속 살아있음 -> 인스턴스를 종료하고 싶으면 스팟 요청 취소 후에 인스턴스를 종료해야 함
- 스팟 플릿 - 스팟 인스턴스 세트를 정의하는 방법 (온디멘드 포함)
  - 여러 개의 런치 풀과 여러 인스턴스 유형 정의 가능, 그리고 가장 적합한 런치 풀 선택
  - 예산에 도달하거나 원하는 용량에 도달하면 인스턱스를 중지시킴
  - 스팟 인스턴스를 할당하는 전략을 정의해야 함
    - 최저 가격
    - 용량 최적화

#### 전용 인스턴스
- 전용 호스트는 물리적 서버 전체를 예약해서 인스턴스 배치를 제어할 수 있음
- 하드웨어를 공유하지 않음
 
#### EC2 온디맨드
- 사용한 대로 지불
- `Linux`나 `Windows`를 사용한다면 1분 이후에 초 단위로 청구
- 다른 모든 운영체계의 경우에는 1시간 단위로 청구
- 비용이 가장 많이 들지만 바로 지불하지 않고, 장기적인 약정도 필요 없0
- 단기적이고 중단 없는 워크로드가 필요할 때, 또는 애플리케이션의 거동을 예측할 수 없을 때 추천
 
#### 예약 인스턴스
- 온디맨드에 비해 72% 할인을 제공
- 특정한 인스턴스 속성을 예약(인스턴스 타입, 리전, 테넌시, OS) 후,
- 예약 기간을 1년이나 3년으로 지정해서 할인을 더 받을 수 있고, 전부 선결제
- 부분 선결제 또는 선결제 없음 중에 선택 가능 (전부 선결제 선택 시 최대 할인)
- 마켓플레이스에서 살 수 있고, 더 이상 필요가 없어지면 팔 수도 있음
 
#### 전환형 예약 인스턴스
- 특별한 유형의 예약 인스턴스
- 인스턴스 타입, 인스턴스 패밀리, 운영체계, 범위, 테넌시 등을 변경 가능
- 유연성이 더 크기 때문에 할인은 더 적음, 최대 66%
 
#### EC2 절약 플랜
- 장기간 사용하면 할인
- 예약 인스턴스와 마찬가지로 70% 할인
- 1년 내지 3년 동안 시간당 10달러로 약정
- 사용량이 한도를 넘어서면 절약 플랜은 온디맨드 가격으로 청구
- 특정한 인스턴스와 패밀리, 리전으로 고정
 
#### 전용 호스트
- `EC2` 인스턴스 용량이 있는 실제 물리적 서버를 받게 됨
- 법규 준수 요건이 있는 활용 사례나 소켓, 코어, `VM` 소프트웨어 라이선스를 기준으로 청구되는
- 기존의 서버에 연결된 소프트웨어 라이선스가 있는 경우
- 온디맨드로 초당 비용을 지불하거나 1년 또는 3년 동안 예약 가능
- 물리적 서버 자체에 대한 접근권을 갖고 낮은 수준의 하드웨어에 대한 가시성을 제공

#### 전용 인스턴스
- 전용 하드웨어에서 실행되는 인스턴스 (물리적 서버 X)
- 같은 계정에서 다른 인스턴스와 함께 하드웨어를 공유할 수 있고, 인스턴스 배치에 대한 통제권이 없음
- 자신만의 인스턴스를 자신만의 하드웨어에 가짐

#### EC2 용량 예약
- 원하는 기간 동안 특정한 AZ에서 온디맨드 인스턴스를 예약 가능 그리고 필요할 때마다 그 용량에 접근 가능
- 기간 약정 X, 언제라도 용량을 예약하고 취소할 수 있음. 청구 할인도 X 용량을 예약하는 게 유일한 목적
